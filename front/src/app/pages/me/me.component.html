<div class="profile-container">
  <a routerLink="/articles" class="back-button">
    <span class="arrow-icon">←</span>
  </a>

  <div class="header-actions">
    <h2>Profil utilisateur</h2>
  </div>

  @if (user$ | async; as user) {

  <form [formGroup]="form" (ngSubmit)="submit()" class="profile-card">
    <div class="info-group">
      <label for="name">Nom d'utilisateur</label>
      <input
        id="name"
        type="text"
        formControlName="name"
        class="form-input"
        [class.error]="form.get('name')?.invalid && form.get('name')?.touched"
      />
    </div>

    <div class="info-group">
      <label for="email">Adresse e-mail</label>
      <input
        id="email"
        type="email"
        formControlName="email"
        class="form-input"
        [class.error]="form.get('email')?.invalid && form.get('email')?.touched"
      />
    </div>

    <div class="info-group">
      <label for="password">Nouveau mot de passe (optionnel)</label>
      <input
        id="password"
        type="password"
        formControlName="password"
        class="form-input"
        placeholder="••••••••"
      />
    </div>

    <button
      type="submit"
      class="btn-save"
      [disabled]="form.invalid || form.pristine"
    >
      Sauvegarder
    </button>
  </form>

  <div class="subscriptions-section">
    <h3>Abonnements</h3>
    <div class="subscriptions-grid">
      @for (sub of user.subscriptions; track sub.id) {
      <div class="subscription-item">
        <div class="sub-info">
          <span class="sub-title">{{ sub.title }}</span>
          <span class="sub-desc">{{ sub.description }}</span>
        </div>
        <button
          class="unsubscribe-btn"
          type="button"
          (click)="unsubscribe(sub.id)"
        >
          Se désabonner
        </button>
      </div>
      } @empty {
      <p class="no-subs">Vous n'êtes abonné à aucun thème.</p>
      }
    </div>
  </div>

  } @else {
  <div class="loading">
    <p>Chargement de vos informations...</p>
  </div>
  }
</div>
